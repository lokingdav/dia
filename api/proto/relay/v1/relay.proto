syntax = "proto3";
package denseid.relay.v1;

import "google/protobuf/timestamp.proto";

option go_package = "github.com/dense-identity/denseid/api/go/relay/v1;relaypb";

message SubscribeRequest {
  string topic    = 1;
  string sender_id = 2;
}

message RelayMessage {
  string topic    = 1;
  string corr_id = 2;
  string sender_id = 3;
  bytes  payload    = 4;
}

message PublishRequest {
  string topic = 1;
  bytes ticket = 2;
  RelayMessage message = 3;
}

message PublishResponse {
  string status = 1;
  google.protobuf.Timestamp relay_at = 2;
}

service RelayService {
  rpc Publish  (PublishRequest)   returns (PublishResponse);
  rpc Subscribe(SubscribeRequest) returns (stream RelayMessage);
}
